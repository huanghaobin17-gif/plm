<style>
  .messageTriangle {
    width: 0;
    height: 0;
    border-bottom: 8px solid #FFB800;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    left: 90px;
    top: -8px;
    position: absolute;
  }
  .messageRange{
    width: 200px;
    height: 20px;
    position: absolute;
    background-color:#FFB800;
    left: -70px;
    line-height: 20px;
    display: none
  }
  .red{ border:1px solid #d00; background:#ffe9e8; color:#d00;}
</style>
<div class="layui-layout layui-layout-admin">
  <div class="layui-header">
    <!-- 头部区域 -->
    <ul class="layui-nav layui-layout-left">
      <li class="layui-nav-item layadmin-flexible" lay-unselect>
        <a href="javascript:;" layadmin-event="flexible" title="侧边伸缩">
          <i class="layui-icon layui-icon-shrink-right" id="LAY_app_flexible"></i>
        </a>
      </li>
      <!--<li class="layui-nav-item layui-this layui-hide-xs layui-hide-sm layui-show-md-inline-block">
        <a lay-href="" title="">
          控制台
        </a>
      </li>-->
      <!--<li class="layui-nav-item layui-hide-xs" lay-unselect>-->
        <!--<a href="http://www.layui.com/admin/" target="_blank" title="前台">-->
          <!--<i class="layui-icon layui-icon-website"></i>-->
        <!--</a>-->
      <!--</li>-->
      <li class="layui-nav-item" lay-unselect>
        <a href="javascript:;" layadmin-event="refresh" title="刷新">
          <i class="layui-icon layui-icon-refresh-3"></i>
        </a>
      </li>
    </ul>
    <ul class="layui-nav layui-layout-right" lay-filter="layadmin-layout-right">
      <li class="layui-nav-item" lay-unselect>
        <a href="javascript:;">
          <cite>{$a=session('current_hospitalname')}</cite>
        </a>
      </li>
      <li class="layui-nav-item" lay-unselect>
        <a href="javascript:;" layadmin-event="screen" id="screen" title="大屏显示">
          <i class="layui-icon layui-icon-chart-screen" style="font-size: 20px;"></i>
        </a>
      </li>
      <li class="layui-nav-item" lay-unselect>
        <a href="javascript:;" layadmin-event="cache" id="cache" title="更新缓存">
          <i class="layui-icon layui-icon-template"></i>
        </a>
      </li>


      <li class="layui-nav-item layui-hide-xs systemMessage" lay-unselect>


        <!--<a lay-href="app/message/" layadmin-event="message">-->
        <a href="javascript:;" layadmin-event="message" title="我的消息">
          <i class="layui-icon layui-icon-notice"></i>
          <!-- 如果有新消息，则显示小圆点 -->
          <script type="text/html" template lay-url="/tecev/start/json/message/new.js">
            <if condition="$taskNum neq 0">
              <span class="layui-badge-dot"></span>
            </if>
          </script>
        </a>
        <div class="messageRange">
          <div class="messageTriangle"></div>
          <span class="messageText">
             您有一个新的任务，请注意查看
          </span>
        </div>
      </li>

      <li class="layui-nav-item layui-hide-xs" lay-unselect>
        <a href="javascript:;" layadmin-event="theme" title="切换主题">
          <i class="layui-icon layui-icon-theme"></i>
        </a>
      </li>
      <li class="layui-nav-item layui-hide-xs" lay-unselect>
        <a href="javascript:;" layadmin-event="note" title="我的便签">
          <i class="layui-icon layui-icon-note"></i>
        </a>
      </li>
      <li class="layui-nav-item" lay-unselect>
        <script type="text/html" template lay-url="/tecev/start/json/user/session.js"
                lay-done="layui.element.render('nav', 'layadmin-layout-right');">
          <a href="javascript:;">
            <cite>{$a=session('username')}</cite>
          </a>
          <dl class="layui-nav-child">
            <dd><a lay-href="BaseSetting/User/userInfo.html"><i class="iconfont icon-wo"></i> 基本资料</a></dd>
            <if condition="$showChangHospitalOption">
              <dd><a href="javascript:;" layadmin-event="qiehuan"><i class="iconfont icon-shoushuru"></i> 切换医院</a></dd>
            </if>
            <hr>
            <dd layadmin-event="logout" style="text-align: center;"><a><i class="iconfont icon-tuichu1"></i>  退出登录</a></dd>
          </dl>
        </script>
      </li>

      <li class="layui-nav-item layui-hide-xs" lay-unselect>
        <a href="javascript:;" layadmin-event="about"><i class="layui-icon layui-icon-more-vertical"></i></a>
      </li>
      <li class="layui-nav-item layui-show-xs-inline-block layui-hide-sm" lay-unselect>
        <a href="javascript:;" layadmin-event="more"><i class="layui-icon layui-icon-more-vertical"></i></a>
      </li>
    </ul>
  </div>

  <!-- 侧边菜单 -->
  <div class="layui-side layui-side-menu">
    <div class="layui-side-scroll">
      <script type="text/html" template lay-url="/A/Login/getMenus"
              lay-done="layui.element.render('nav', 'layadmin-system-side-menu');" id="TPL_layout">

        <div class="layui-logo" style="font-size: 16px;padding: 0 3px;" lay-href="">
          <span>{{ layui.setter.name || 'layuiAdmin' }}</span>
        </div>

        <ul class="layui-nav layui-nav-tree" lay-shrink="all" id="LAY-system-side-menu" lay-filter="layadmin-system-side-menu">
          {{#
          var path =  layui.router().path
          ,pathURL = layui.admin.correctRouter(path.join('/'))
          ,dataName = layui.setter.response.dataName;
          layui.each(d[dataName], function(index, item){
          var hasChildren = typeof item.list === 'object' && item.list.length > 0
          ,classSelected = function(){
          var match = item.include.indexOf(path[0])>=0 || (index == 0 && !path[0])
          || (item.jump && pathURL == layui.admin.correctRouter(item.jump));
          if(match){
          return hasChildren ? 'layui-nav-itemed' : 'layui-this';
          }
          return '';
          }
          ,url = (item.jump && typeof item.jump === 'string') ? item.jump : item.name;
          }}
          <li data-name="{{ item.name || '' }}" data-jump="{{ item.jump || '' }}" class="layui-nav-item {{ classSelected() }}">
            <a href="javascript:;" {{ hasChildren ? '' : 'lay-href="'+ url +'"' }} lay-tips="{{ item.title }}" lay-direction="2">
            <i class="layui-icon {{ item.icon }}"></i>
            <cite>{{ item.title }}</cite>
            </a>
            {{# if(hasChildren){ }}
            <dl class="layui-nav-child">
              {{# layui.each(item.list, function(index2, item2){
              var hasChildren2 = typeof item2.list == 'object' && item2.list.length > 0
              ,classSelected2 = function(){
              var match = (item.include.indexOf(path[0]) >= 0 && item2.include.indexOf(path[1]) >= 0)
              || (item2.jump && pathURL == layui.admin.correctRouter(item2.jump));
              if(match){
              return hasChildren2 ? 'layui-nav-itemed' : 'layui-this';
              }
              return '';
              }
              ,url2 = (item2.jump && typeof item2.jump === 'string')
              ? item2.jump
              : [item.name, item2.name, ''].join('/');
              }}
              <dd  data-name="{{ item2.name || '' }}"  data-jump="{{ item2.jump || '' }}"
                   {{ classSelected2() ? ('class="'+ classSelected2() +'"') : '' }}>
              <a href="javascript:;" {{ hasChildren2 ? '' : 'lay-href="'+ url2 +'"' }}>{{ item2.title }}</a>
              {{# if(hasChildren2){ }}
              <dl class="layui-nav-child">
                {{# layui.each(item2.list, function(index3, item3){
                var match = (path[0] == item2.name && path[1] == item3.name)
                || (item3.jump && pathURL == layui.admin.correctRouter(item3.jump))
                ,url3 = (item3.jump && typeof item3.jump === 'string')
                ? item3.jump
                : [item2.name, item3.name].join('/');
                }}
                <dd data-name="{{ item3.name || '' }}"  data-jump="{{ item3.jump || match }}"
                    {{ match ? 'class="layui-this"' : '' }}>
                <a href="javascript:;" lay-href="{{ url3 }}" {{ item3.iframe ? 'lay-iframe="true"' : '' }}>{{ item3.title }}</a>
                </dd>
                {{# }); }}
              </dl>
              {{# } }}
              </dd>
              {{# }); }}
            </dl>
            {{# } }}
          </li>
          {{# }); }}
        </ul>
      </script>
    </div>
  </div>


  <!-- 页面标签 -->
  <script type="text/html" template lay-done="layui.element.render('nav', 'layadmin-pagetabs-nav')">
    {{# if(layui.setter.pageTabs){ }}
    <div class="layadmin-pagetabs" id="LAY_app_tabs">
      <div class="layui-icon layadmin-tabs-control layui-icon-prev" layadmin-event="leftPage"></div>
      <div class="layui-icon layadmin-tabs-control layui-icon-next" layadmin-event="rightPage"></div>
      <div class="layui-icon layadmin-tabs-control layui-icon-down">
        <ul class="layui-nav layadmin-tabs-select" lay-filter="layadmin-pagetabs-nav">
          <li class="layui-nav-item" lay-unselect>
            <a href="javascript:;"></a>
            <dl class="layui-nav-child layui-anim-fadein">
              <dd layadmin-event="closeThisTabs"><a href="javascript:;">关闭当前标签页</a></dd>
              <dd layadmin-event="closeOtherTabs"><a href="javascript:;">关闭其它标签页</a></dd>
              <dd layadmin-event="closeAllTabs"><a href="javascript:;">关闭全部标签页</a></dd>
            </dl>
          </li>
        </ul>
      </div>
      <div class="layui-tab" lay-unauto lay-allowClose="true" lay-filter="layadmin-layout-tabs">
        <ul class="layui-tab-title" id="LAY_app_tabsheader">
          <li lay-id="/"><i class="layui-icon layui-icon-home"></i></li>
        </ul>
      </div>
    </div>
    {{# } }}
  </script>


  <!-- 主体内容 -->
  <div class="layui-body" id="LAY_app_body">
    <input type="hidden" name="sessionUserid" value="{$sessionUserid}">
    <div class="layadmin-tabsbody-item layui-show"></div>
  </div>

  <div class="layui-footer">
    <span class="fl">{$Think.config.COMPANY_NAME} 版权所有 © 2015~2018</span>
    <!--<span class="fr">粤ICP备17098446号</span>-->
  </div>

  <!-- 辅助元素，一般用于移动设备下遮罩 -->
  <div class="layadmin-body-shade" layadmin-event="shade"></div>

</div>
<script>
    $(document).ready(function () {
        $("#qiehuan").on('click',function () {
            return false;
        });

        //大屏显示
        $('#screen').on('click',function() {
            var url = admin_name+'/Tool/screen.html';
            window.open(url,"blank");
        });

        //更新缓存
        $('#cache').on('click',function() {
            var url = admin_name+'/Cache/index.html';
            $.ajax({
                type: "POST",
                dataType: "json",
                url: url,
                //datatype: "html",//"xml", "html", "script", "json", "jsonp", "text".
                beforeSend: function () {
                    layer.msg('正在更新缓存，请稍候...', {
                        icon: 16,
                        time: 14000,
                        shade: 0.01
                    });
                },
                //成功返回之后调用的函数
                success: function (data) {
                    if (data.status == 1) {
                        layer.msg(data.msg, {icon: 1});
                    } else {
                        layer.msg(data.msg, {icon: 2});
                    }
                },
                //调用出错执行的函数
                error: function () {
                    //请求出错处理
                    layer.msg('服务器繁忙', {icon: 2});
                },
                complete: function () {
                    layer.closeAll('msg');
                }
            });
        });
    });
</script>