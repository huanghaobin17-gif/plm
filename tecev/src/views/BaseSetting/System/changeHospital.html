<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <include file="Public:layerHeader"/>
</head>
<body>
<div class="containDiv">
    <table class="layui-table">
        <colgroup>
            <col width="12%">
            <col width="50%">
            <col width="18%">
            <col>
        </colgroup>
        <thead>
        <tr>
            <th>序号</th>
            <th>医院名称</th>
            <th>医院代码</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <volist name="myHospitals" id="vo">
            <tr>
                <td>{$key+1}</td>
                <td>{$vo.hospital_name}</td>
                <td>{$vo.hospital_code}</td>
                <td>
                    <if condition="$current_id neq $vo['hospital_id']">
                        <div class="layui-btn-group">
                            <button class="layui-btn layui-btn-xs layui-btn-normal qiehuan" lay-submit lay-filter="qiehuan" data-id="{$vo.hospital_id}">切换医院</button>
                        </div>
                        <else/>
                        <div class="layui-btn-group">
                            <button class="layui-btn layui-btn-xs layui-btn-primary">当前所在</button>
                        </div>
                    </if>
                </td>
            </tr>
        </volist>
        </tbody>
    </table>
</div>
</body>
</html>
<script>
    layui.use(['layer', 'form'], function() {
        var form = layui.form;
        $(".qiehuan").on('click',function () {
            var url = admin_name+'/System/changeHospital';
            var params = {};
            params['hsid'] = $(this).attr('data-id');
            $.ajax({
                type: "POST",
                url: url,
                data: params,
                //datatype: "html",//"xml", "html", "script", "json", "jsonp", "text".//返回数据的格式
                beforeSend: function () {
                    layer.load(1);
                },
                //成功返回之后调用的函数
                success: function (data) {
                    if (data.status == 1) {
                        layer.msg(data.msg, {icon: 1, time: 1000}, function () {
                            parent.location.reload();
                        });
                    } else {
                        layer.msg(data.msg, {icon: 2,time:3000});
                    }
                },
                //调用出错执行的函数
                error: function () {
                    //请求出错处理
                    layer.msg('服务器繁忙', {icon: 5});
                },
                complete: function () {
                    layer.closeAll('loading');
                }
            });
        });
    });
</script>
