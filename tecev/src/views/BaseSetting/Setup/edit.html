<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>修改用户</title>
<link type="text/css" rel="stylesheet" href="__PUBLIC__/css/style.css" />
<link type="text/css" rel="stylesheet" href="__PUBLIC__/css/forms.css" />
<style>
body{ background:#ffffff; width:100%;}
table.info{background:#e5e5e5}
.info tr:nth-child(odd) td{ background:#ffffff}
.info tr:nth-child(even) td{ background:#f9f9f9}
.info td{ padding:8px 0px 8px 8px;}
font{ color:red; float:left}
.input_btn{ margin:0px;}
.input_box,.zj_select{ margin:0px;}
.remark{ border:1px solid #e5e5e5; padding:2px; line-height:25px; width:400px; margin-right:20px;}
.input_box1 {margin:0px;}

</style>
<script src="__PUBLIC__/js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="__PUBLIC__/js/common.js" type="text/javascript"></script>
    <script src="__PUBLIC__/js/lhgdialog.js?skin=iblue" type="text/javascript"></script>
    <script src="__PUBLIC__/js/setup/user.js" type="text/javascript"></script>

</head>

<body>

<form onsubmit="return check();" method="post" action="__SELF__">
	<table width="100%" cellpadding="2" cellspacing="1" class="info">
        <tr>
           <td width="15%" align="right">工号：</td>
           <td align="left"><input type="text"  readonly="readonly" class="input_box" name="userid" value="<?php echo $userid; ?>" /></td>
        </tr>
        <tr>
           <td width="15%" align="right">姓名：</td>
           <td align="left"><input type="text" class="input_box fl" id="username" name="username" value="<?php echo $username; ?>" /><font>*</font>
           <p id="dusername" class="f_red fl" style="display:none"></p>
           </td>
        </tr>
        <tr>
           <td width="15%" align="right">密码：</td>
           <td align="left"><input type="password" class="input_box fl" id="password" name="password" value="" /><font>*</font>
           <p id="dpassword" class="f_red fl" style="display:none"></p>
           </td>
        </tr>
        <tr>
           <td width="15%" align="right">确认密码：</td>
           <td align="left"><input type="password" class="input_box fl" id="checkpassword" name="checkpassword" value="" /><font>*</font>
           <p id="dcheckpassword" class="f_red fl" style="display:none"></p>
           </td>
        </tr>
        <tr>
           <td width="15%" align="right">性别：</td>
           <td align="left"><input type="radio" name="gender" id="man" value="0" /><label>男</label><input type="radio" name="gender" id="woman" value="1" /><label>女</label></td>
        </tr>
        <tr>
           <td width="15%" align="right">联系方式：</td>
           <td align="left"><input type="text" class="input_box fl" id="telephone" name="telephone" value="<?php echo $telephone; ?>" /><font>*</font>
           <p id="dtelephone" class="f_red fl" style="display:none"></p>
           </td>
        </tr>
        <tr>
           <td width="15%" align="right">角色：</td>
           <td align="left"><select name="roleid" id="roleid" class="select" >
           <option value="">---请选择角色---</option>
           <?php  foreach($role as $key => $value){  ?>
               <?php if($value['roleid'] == $myroleid){ ?>
                 <option value="<?php echo $value['roleid']; ?>" selected="selected"><?php echo $value['role']; ?></option>
               <?php }else{ ?>
                 <option value="<?php echo $value['roleid']; ?>"><?php echo $value['role']; ?></option>
               <?php } ?>
           <?php } ?></select></td>
           </select></td>
        </tr>
        <tr>
            <td width="15%" align="right">工作科室：</td>
            <td>
                <font size="50px"><input type="checkbox" onclick="checkall(this.form);"/>全选</font><br>
                <input type="checkbox" value="0" id="departid0" name="departid">院长 &nbsp;&nbsp;
                <?php foreach($department as $k => $v){ ?>
                <?php if(in_array($v[departid],$mydepartids)){ ?>
                <input type="checkbox" id="<?php echo 'departid'.($k+1) ?>"  value="<?php echo $v[departid]; ?>" name="departid" checked="checked"><?php echo $v[department] ?>&nbsp;&nbsp;
                <?php }else{ ?>
                <input type="checkbox" id="<?php echo 'departid'.($k+1) ?>"  value="<?php echo $v[departid]; ?>" name="departid" ><?php echo $v[department] ?>&nbsp;&nbsp;
                <?php } } ?>
                <input type="text" id="depart"  name="arr_departid" value="" style="display: none"/>
            </td>

        </tr>
        <tr>
           <td width="15%" align="right">人员状态：</td>
           <td align="left"><input type="radio" name="status" id="on" value="0" /><label>在职</label><input type="radio" name="status" id="off" value="1" /><label>离职</label></td>
        </tr>
         <tr>
           <td width="15%" align="right">备注：</td>
           <td align="left"><textarea name="remark" class="remark"><?php echo $remark; ?></textarea></td>
        </tr>
        <tr>
           <td colspan="2" align="center"><input type="submit"  class="input_btn" value="确定无误并提交" />
                <input type="reset" class="input_btn" value="重置" style=" margin-left:50px" /></td>
        </tr>
	</table>
</form>
<script>
$().ready(function(){
    var arr_departid = eval('<?php echo $arr_departid; ?>');
   var count =  eval('<?php echo $arr_departid; ?>').length;
    for(var i=0;i<count;i++){
        document.getElementById('departid'+arr_departid[i]).checked = true;
    }
	if({$gender}==0){
              document.getElementById("man").checked = true;
              }else{
              document.getElementById("woman").checked = true;
              }
	if({$status}==0){
              document.getElementById("on").checked=true;
              }else{
              document.getElementById("off").checked=true;
             }
               var roleid = document.getElementById("roleid");
                select(roleid,{$roleid});

});
             function select(selectName,selectValue){
	for(var i=0; i<selectName.options.length; i++){  
	    if(selectName.options[i].value == selectValue){  
	    	selectName.options[i].selected = true;   
	    }  
	}
}
</script>
<script>
    function check(){
        //验证用户名

        var username = $("input[name='username']").val();
        username = trim(username,'g');
        if(username == ''){
            $.dialog({
                icon: 'error_24.gif',
                title:false,
                heght: '5em',
                time: 1,
                content: '用户名不能为空'
            });
            return false;
        }
        //验证密码是否一致
        var password = $("input[name='password']").val();
        password = trim(password,'g');
        var checkpassword = $("input[name='checkpassword']").val();
        checkpassword = trim(checkpassword,'g');
        if(password != checkpassword){
            $.dialog({
                icon: 'error_24.gif',
                title:false,
                heght: '5em',
                time: 1,
                content: '两次输入密码不一致'
            });
            return false;
        }
        //验证联系方式
        var telephone = $("input[name='telephone']").val();
        telephone = trim(telephone,'g');
        if(telephone == ''){
            $.dialog({
                icon: 'error_24.gif',
                title:false,
                heght: '5em',
                time: 1,
                content: '手机号码不能为空'
            });
            return false;
        }else{
            if(!checkTel(telephone)){
                $.dialog({
                    icon: 'error_24.gif',
                    title:false,
                    heght: '5em',
                    time: 1,
                    content: '请输入正确的手机号码'
                });
                return false;
            }
        }
        //验证角色
        var roleid = $("select[name='roleid']").val();
        if(roleid == 0){
            $.dialog({
                icon: 'error_24.gif',
                title:false,
                heght: '5em',
                time: 1,
                content: '请选择角色'
            });
            return false;
        }
        //验证科室
        var chk_value =[];
        $('input[name="departid"]:checked').each(function(){
            chk_value.push($(this).val());
        });
        if(chk_value==null){
            $.dialog({
                icon: 'error_24.gif',
                title:false,
                heght: '5em',
                time: 1,
                content: '请选择科室'
            });
        }
        $("#depart").val(chk_value);
    }
</script>
</body>
</html>
