<include file="Public:head"/>
<?php if($menuData = get_menu_name('Assets','Transfer','getList')):?>
<title>{$menuData['actionname']}</title>
<?php endif?>
<style>
    .layui-tab-title .layui-this:after{border-color: #dddddd !important;border: none !important;}
    /*分类 科室按目录分*/
    .searchList {
        height: 4rem;
    }

    .searchList li {
        height: 4rem;
        padding-left: 32%;
        position: relative;
    }

    .searchList .wx-icon{
        font-size: 2.5rem;
        position: absolute;
        left: 3%;
        top: 0.7rem;
    }
    .searchList .wx-icon-shebeifenlei {
        color: #FF5722;
    }
    .searchList .wx-icon-keshiguanli{
        color: #5fb878;
    }
    .searchList h2 {
        display: inline-block;
        font-size: 1rem;
    }
    .searchList h3 {
        font-size: 0.75rem;
        color: #707070
    }
    /**/
    .line {
        border-right: 1px solid #c9c9c9;
        position: absolute;
        right: 0;
        width: 1px;
        height: 80%;
        top: 0;
    }
    .sum {
        color: #FF5722;
    }
    .using {
        color: #009688
    }
    #transferList li {
        margin-top: 0.625rem;
        margin-bottom: 0.625rem;
        width: 100%;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }
    .swiper-container {
        height: 9.6rem;
        padding: 0.9rem 0;
        margin-left: 0.5rem;
    }
    .weui-popup__modal .weui-icon-cancel {
        position: absolute;
        right: 0.2rem;
        top: 0.8rem;
        color: #888;
        font-size: 1.5rem;
    }
    .weui-popup__modal{
        background-color: #fff;
    }
    .popupContent{
        height: 95%;
    }

    /*设备分类竖向选项卡*/
    .layui-tab-title{
        float: left;
        width: 100%;
        height: 100%;
        border-bottom: none;
        border-right: 1px solid #dddddd;
        border-top: none;
    }
    .layui-tab-title li{
        display: block;
        text-align: left;
        border-bottom: 1px solid #dddddd;
        white-space:normal;
        word-break : break-all;
        line-height: 1.2rem;
        font-size: 0.75rem;
        padding: 0.8rem;
        background-color: #f9f9f9;
    }
    .layui-tab-title .layui-this{
        background-color: #fff;
        color: #009688;
    }
    .layui-tab-title .layui-this:after{
        border-color: #dddddd;
        border: none;
    }
    .layui-tab-content{
        float: left;
        padding: 0;
    }
    .layui-tab-item ul li{
        padding: 0.6438rem 1rem;
        border-bottom: 1px solid #e6e6e6;
        position: relative;
    }
    .layui-tab-item ul li .layui-icon-right{
        position: absolute;
        right: 0.5rem;
        top: 30%;
        opacity: 0.5;
    }
    .weui-grid{
        padding: 1rem;
    }
    .layui-fixbar{
        bottom: 10rem;
    }
    .assetsSum{
        position: absolute;
        top: 0.1rem;
        right: 0.1rem;
    }
    .detail{
        padding-left: 0;
    }
    .departmentAssetsSum{width:100%;position: absolute;bottom: 0;left: 0;text-align:center;color: #FF5722;}
</style>
<body>
<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-body">
            <button class="layui-btn layui-btn-fluid enterButton mgt1rem" id="transferListsBrcode">扫码转科</button>
            <div class="mgt1rem">
                <div class="weui-search-bar" id="searchBar">
                    <form class="weui-search-bar__form" action="#" id="searchForm">
                        <div class="weui-search-bar__box">
                            <i class="weui-icon-search"></i>
                            <input type="search" class="weui-search-bar__input" id="searchInput">
                            <a href="javascript:" class="weui-icon-clear" id="searchClear"></a>
                        </div>
                        <label class="weui-search-bar__label" id="searchText"
                               style="transform-origin: 0px 0px 0px; opacity: 1; transform: scale(1, 1);">
                            <i class="weui-icon-search"></i>
                            <span>搜索(设备名称、编号、规格型号、状态)</span>
                        </label>
                    </form>
                    <a href="javascript:" class="weui-search-bar__cancel-btn" id="searchCancel">取消</a>
                    <div class="stopCancelSearch"></div>
                </div>
            </div>
            <div style="margin-top: 1.5rem;">
                <ul class="searchList">
                    <div class="layui-col-xs6">
                        <a href="javascript:;" id="categoryListButton">
                            <li>
                                <i class="wx-icon wx-icon-shebeifenlei"></i>
                                <h2>设备分类</h2>
                                <h3>医疗器械分类目录</h3>
                                <div class="line"></div>
                            </li>
                        </a>
                    </div>
                    <div class="layui-col-xs6">
                        <a href="javascript:;" id="departmentListButton">
                            <li>
                                <i class="wx-icon wx-icon-keshiguanli"></i>
                                <h2>使用科室</h2>
                                <h3>按医院科室分类</h3>
                            </li>
                        </a>
                    </div>
                </ul>
                <div id="categoryList" class="weui-popup__container">
                    <div class="weui-popup__overlay"></div>
                    <div class="weui-popup__modal">
                        <div class="popupTopTitleDiv">
                            <span class="popupTopTitle">设备分类</span>
                            <i class="weui-icon-cancel"></i>
                        </div>
                        <div class="popupContent">
                            <div class="layui-tab">
                                <div class="popupContentLeft layui-col-xs5">
                                    <ul class="layui-tab-title">
                                        <volist name="cates" id="vo">
                                            <if condition="$vo['parentid'] eq 0">
                                                <php>$show = ($key == 0) ? 'layui-this' : ''</php>
                                                <li class="pcate {$show}" data-id="{$vo.catid}">{$vo.category}<font color="red">({$vo.assetssum})</font></li>
                                            </if>
                                        </volist>
                                    </ul>
                                </div>
                                <div class="layui-tab-content layui-col-xs7">
                                    <volist name="cates" id="vo">
                                        <if condition="$vo.parentid eq 0">
                                            <php>$show = ($key == 0) ? 'layui-show' : ''</php>
                                            <div class="layui-tab-item {$show}">
                                                <php>
                                                    if($vo['parentid'] == 0){
                                                        if($vo['assetssum'] > 0){
                                                            echo '<li class="soncat" data-id="'.$vo['catid'].'"><span>全部（<span style="color:red;">'.$vo['assetssum'].'</span>）</span><i class="layui-icon layui-icon-right"></i></li>';
                                                        }else{
                                                            echo '<li class="soncat" data-id="'.$vo['catid'].'"><span>全部（<span>'.$vo['assetssum'].'</span>）</span><i class="layui-icon layui-icon-right"></i></li>';
                                                        }
                                                    };
                                                </php>
                                                <ul>
                                                    <volist name="cates" id="v">
                                                        <php>
                                                            if($v['parentid'] == $vo['catid']){
                                                                if($v['assetssum'] > 0){
                                                                    echo '<li class="soncat" data-id="'.$v['catid'].'"><span>'.$v['category'].'</span>（<span style="color:red;">'.$v['assetssum'].'</span>）<i class="layui-icon layui-icon-right"></i></li>';
                                                                }else{
                                                                    echo '<li class="soncat" data-id="'.$v['catid'].'"><span>'.$v['category'].'</span>（<span>'.$v['assetssum'].'</span>）<i class="layui-icon layui-icon-right"></i></li>';
                                                                }
                                                            };
                                                        </php>
                                                    </volist>
                                                </ul>
                                            </div>
                                        </if>
                                    </volist>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="departmentList" class="weui-popup__container">
                    <div class="weui-popup__overlay"></div>
                    <div class="weui-popup__modal">
                        <div class="popupTopTitleDiv">
                            <span class="popupTopTitle">科室列表</span>
                            <i class="weui-icon-cancel"></i>
                        </div>
                        <div class="popupContent">
                            <div class="weui-grids">
                                <volist name="departs" id="vo">
                                    <div class="weui-grid js_grid" data-id="{$vo.departid}">
                                        <p class="weui-grid__label">
                                            <span class="department">{$vo.department}</span>
                                            <if condition="$vo.assetssum neq 0">
                                                <div class="departmentAssetsSum">（{$vo.assetssum}）</div>
                                                <else/>
                                                <div class="departmentAssetsSum" style="color: #666;">（0）</div>
                                            </if>
                                        </p>
                                    </div>
                                </volist>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="departmentLevel" class="weui-popup__container">
                    <div class="weui-popup__overlay"></div>
                    <div class="weui-popup__modal">
                        <div class="popupTopTitleDiv">
                            <span class="popupTopTitle">科室列表(多级)</span>
                            <i class="weui-icon-cancel"></i>
                        </div>
                        <div class="popupContent">
                            <div class="layui-tab">
                                <div class="popupContentLeft layui-col-xs5">
                                    <ul class="layui-tab-title">
                                        <volist name="departs" id="vo">
                                            <if condition="$vo['parentid'] eq 0">
                                                <php>$show = ($key == 0) ? 'layui-this' : ''</php>
                                                <li class="{$show}">{$vo.department} <span
                                                        class="sum">{$vo.assetssum}</span></li>
                                            </if>
                                        </volist>
                                    </ul>
                                </div>
                                <div class="layui-tab-content layui-col-xs7">
                                    <volist name="departs" id="vo">
                                        <if condition="$vo.parentid eq 0">
                                            <php>$show = ($key == 0) ? 'layui-show' : ''</php>
                                            <div class="layui-tab-item {$show}">
                                                <ul>
                                                    <volist name="departs" id="v">
                                                        <php>
                                                            if($v['parentid'] == $vo['departid']){
                                                            echo '
                                                            <li><span>'.$v['department'].'</span><i
                                                                    class="layui-icon layui-icon-right"></i></li>
                                                            ';
                                                            };
                                                        </php>
                                                    </volist>
                                                </ul>
                                            </div>
                                        </if>
                                    </volist>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-card">
        <div class="layui-card-header">
            <img class="formImage" src="__PUBLIC__/mobile/images/icon/list.png">
            <h2 class="list_title">设备列表 </h2>
            <span class="sum total_sum"></span> 台
            <a class="order">排序
                <img class="formImage" src="__PUBLIC__/mobile/images/icon/order.png">
                <div class="orderList">
                    <dl>
                        <dt>降序</dt>
                        <dd>
                            <span class="orderTypeButton" orderType="DESC" orderSort="department">按科室名称</span>
                        </dd>
                        <dd>
                            <span class="orderTypeButton" orderType="Desc" orderSort="assetssum">按科室设备数量</span>
                        </dd>
                        <dd>
                            <span class="orderTypeButton" orderType="Desc" orderSort="status">按设备状态</span>
                        </dd>
                        <dd>
                            <span class="orderTypeButton" orderType="Desc" orderSort="opendate">按设备启用时间</span>
                        </dd>
                        <dt>升序</dt>
                        <dd>
                            <span class="orderTypeButton" orderType="Asc" orderSort="department">按科室名称</span>
                        </dd>
                        <dd>
                            <span class="orderTypeButton" orderType="Asc" orderSort="assetssum">按科室设备数量</span>
                        </dd>
                        <dd>
                            <span class="orderTypeButton" orderType="Asc" orderSort="status">按设备状态</span>
                        </dd>
                        <dd>
                            <span class="orderTypeButton" orderType="Asc" orderSort="opendate">按设备启用时间</span>
                        </dd>
                    </dl>
                </div>
            </a>
        </div>
        <div class="layui-card-body" id="layui-card-body">
            <ul id="transferList">

            </ul>
        </div>
    </div>
</div>
</body>
<include file="Public:buttom"/>
<script>
    var url = '{$url}';
</script>
<script src="__PUBLIC__/js/swiper.min.js"></script>
<script src="__PUBLIC__/mobile/js/assets/transfer/getList.js?v={:mt_rand(1,54561)}"></script>